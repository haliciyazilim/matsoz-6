function InteractiveGrids(e){this.id=InteractiveGrids.GetId(),e.rows?this.rows=e.rows:this.rows=8,e.cols?this.cols=e.cols:this.cols=8,this.vertexLetters=e.vertexLetters,this.size=e.size,this.position=e.position,this.style=e.style,this.points=[],this.vertexes=[],this.circles=[],this.lines=[];for(var t=0;t<=this.rows;t++)this.lines.push((new Path.Line(this.position.add(0,this.size*t),this.position.add(this.size*this.cols,this.size*t))).set_style(this.style));for(var t=0;t<=this.cols;t++)this.lines.push((new Path.Line(this.position.add(this.size*t,0),this.position.add(this.size*t,this.size*this.rows))).set_style(this.style));for(var t=0;t<=this.rows;t++)for(var n=0;n<=this.cols;n++){var r=this.position.add(this.size*t,this.size*n),i=new Path.Circle(r,this.size*.3);i.set_style({fillColor:new RgbColor(1,1,1,0)}),i.class="InteractiveGridCircles"+this.id,this.circles.push(i)}return this}function PantographShapes(e,t){this.pointsArr=[];for(var n=0;n<e.length;n++)this.pointsArr[n]=e[n];return this.centerPoint=Util.centerOfPoints(this.pointsArr),this.drawShape=function(){var e=new Group,n=new Path;n.moveTo(this.pointsArr[0].x,this.pointsArr[0].y-t),n.lineTo(this.pointsArr[1].x,this.pointsArr[1].y-t),n.lineTo(this.pointsArr[1].x,this.pointsArr[1].y+t),n.lineTo(this.pointsArr[1].x,this.pointsArr[0].y+t),n.lineTo(this.pointsArr[0].x,this.pointsArr[0].y-t),n.closed=!0,n.strokeColor=pantographShapesStrokeColor,n.fillColor=pantographShapesFillColor,n.strokeCap="round",this.centerPoint=Util.centerOfPoints(this.pointsArr);var r=Util.centerOfPoints([this.pointsArr[0],this.pointsArr[3]]);r=r.findPointTo(this.centerPoint,7);var i=new Path.Circle(r,2);i.fillColor="#333";var s=Util.centerOfPoints([this.pointsArr[1],this.pointsArr[2]]);s=s.findPointTo(this.centerPoint,7);var o=new Path.Circle(s,2);return o.fillColor="#333",e.addChild(n),e.addChild(i),e.addChild(o),e},this.shape=this.drawShape(),this.shape.parentObject=this,this.setPos=function(e){var t=e.subtract(this.shape.position);for(var n=0;n<this.pointsArr.length;n++)this.pointsArr[n]=this.pointsArr[n].add(t);this.shape.position=e,this.centerPoint=Util.centerOfPoints(this.pointsArr),this.computeCurrentAngle()},this.computeOriginalAngle=function(){var e;e=Util.findAngle(this.pointsArr[0].x,this.pointsArr[0].y,this.centerPoint.x,this.centerPoint.y),e=Util.radianToDegree(e),this.originalAngle=e},this.computeCurrentAngle=function(){var e;e=Util.findAngle(this.pointsArr[0].x,this.pointsArr[0].y,this.centerPoint.x,this.centerPoint.y),e=Util.radianToDegree(e),this.currentAngle=e},this.computeOriginalAngle(),this.computeCurrentAngle(),this.setRotation=function(e){for(var t=0;t<this.pointsArr.length;t++)this.pointsArr[t]=this.pointsArr[t].getRotatedPoint(e,this.centerPoint);this.shape.rotate(e,this.centerPoint),this.centerPoint=Util.centerOfPoints(this.pointsArr),this.computeCurrentAngle()},this}function __Styles(){interactionPathWrongStyle={strokeColor:new RgbColor(1,.3,.3,.7),fillColor:new RgbColor(1,.5,.5,.7)},interactionPathCorrectStyle={strokeColor:new RgbColor(0,.7,0,.8),fillColor:new RgbColor(.3,.7,.3,.8)}}InteractiveGrids.prototype.activateRemoveOnClick=function(){this.removeOnClick=!0},InteractiveGrids.prototype.removeShape=function(){this.path.remove();for(var e=0;e<this.vertexes.length;e++)this.vertexes[e].remove();this.vertexes=[];for(var e=0;e<this.points.length;e++)this.points[e].class="InteractiveGridCircles"+this.id;this.path.remove(),this.disableDraw=!1,this.points=[],this.createTool()},InteractiveGrids.prototype.drawShape=function(e){this.path=new Path,this.path.set_style(this.style).set_style({strokeWidth:3,strokeCap:"butt",strokeColor:"#000"});if(e){for(var t=0;t<e.length;t++){var n=e[t].multiply(this.size,this.size).add(this.position);this.points.push(n),this.path.add(n)}this.path.closed=!0,this.appendVertexLetters()}return this},InteractiveGrids.prototype.undo=function(){if(this.path.closed==1){this.path.closed=!1,this.disableDraw=!1;return}this.path.removeSegment(this.path.segments.length-1),this.points.pop(),this.appendVertexLetters();var e=this.vertexes.pop();e.baseCircle.class="InteractiveGridCircles"+this.id,e.remove()},InteractiveGrids.prototype.appendVertexLetters=function(){if(this.vertexLetters==undefined)return;var e=[];for(var t=0;t<this.vertexLetters.length;t++)e.push(this.vertexLetters[t]);if(this.vertexPointTexts)for(var t=0;t<this.vertexPointTexts.length;t++)this.vertexPointTexts[t].remove();this.vertexPointTexts=[];var n=Util.centerOfPoints(this.points);for(var t=0;t<this.points.length;t++){var r=new PointText(this.points[t].findPointTo(n,-13).add(0,6));r.content=e.shift(),r.set_style({fontSize:12,justification:"center",strokeWidth:2,strokeColor:"#000"}),this.vertexPointTexts.push(r)}},InteractiveGrids.prototype.createTool=function(){var e=new Tool,t=this;return this.disableDraw=!1,e.onMouseDown=function(e){if(t.removeOnClick==1){t.removeShape();return}if(t.disableDraw==1)return;if(e.item&&e.item.class=="InteractiveGridCircles"+t.id){e.item.set_style({});var n=(new Path.Circle(e.item.position,4)).set_style({fillColor:new RgbColor(.2,.2,.2),"class":"SelectedGridCircles"+t.id});n.baseCircle=e.item,t.vertexes.push(n),t.path.add(e.item.position),e.item.class="SelectedGridCircles"+t.id,e.item.opacity=1,t.points.push(e.item.position),e.item.insertAbove(t.path),t.appendVertexLetters()}else e.item&&e.item.class=="SelectedGridCircles"+t.id&&t.points.length>2&&(t.path.closed=!0,t.disableDraw=!0)},e.activate(),this},InteractiveGrids.CreateShape=function(e){var t=[],n=new Point(1,1),r=new Point(0,0);switch(e){case 0:t.push(new Point(1,0)),t.push(new Point(0,2)),t.push(new Point(3,2)),n=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 1:t.push(new Point(0,2)),t.push(new Point(2,2)),t.push(new Point(1,0));var i=Util.randomInteger(1,3);n=new Point(i,i),r=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5));break;case 2:t.push(new Point(0,0)),t.push(new Point(0,1)),t.push(new Point(1,1)),n=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5)),r=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5));break;case 3:t.push(new Point(1,1)),t.push(new Point(1,0)),t.push(new Point(0,1)),n=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5)),r=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5));break;case 4:t.push(new Point(0,2)),t.push(new Point(2,2)),t.push(new Point(3,0)),n=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 5:t.push(new Point(2,0)),t.push(new Point(2,2)),t.push(new Point(0,2)),t.push(new Point(0,0)),n=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 6:t.push(new Point(0,0)),t.push(new Point(1,2)),t.push(new Point(3,2)),t.push(new Point(2,0)),n=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 7:t.push(new Point(1,0)),t.push(new Point(0,2)),t.push(new Point(3,2)),t.push(new Point(5,0)),n=new Point(1,Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 8:t.push(new Point(0,2)),t.push(new Point(1,4)),t.push(new Point(3,4)),t.push(new Point(4,2)),t.push(new Point(2,0)),r=new Point(Util.randomInteger(1,4),Util.randomInteger(1,4));break;case 9:t.push(new Point(0,2)),t.push(new Point(1,4)),t.push(new Point(4,5)),t.push(new Point(5,2)),t.push(new Point(2,0)),r=new Point(Util.randomInteger(1,4),Util.randomInteger(1,4));break;case 10:t.push(new Point(0,2)),t.push(new Point(1,4)),t.push(new Point(3,4)),t.push(new Point(4,2)),t.push(new Point(3,0)),t.push(new Point(1,0)),r=new Point(Util.randomInteger(1,4),Util.randomInteger(1,4));break;case 11:t.push(new Point(0,2)),t.push(new Point(1,3)),t.push(new Point(3,4)),t.push(new Point(4,2)),t.push(new Point(3,0)),t.push(new Point(1,1)),r=new Point(Util.randomInteger(1,4),Util.randomInteger(1,4))}for(var s=0;s<t.length;s++)t[s]=t[s].multiply(n).add(r);return t},InteractiveGrids.AreShapesSame=function(e,t){return InteractiveGrids.AreShapesSimilar(e,t,1)},InteractiveGrids.AreShapesSimilar=function(e,t,n){if(e.length!=t.length)return!1;function r(e){var t=[];for(var n=0;n<e.length;n++){var r=e[n],i=e[(n-1+e.length)%e.length],s=e[(n+1)%e.length],o=Math.abs(Util.findAngle(r.x,r.y,s.x,s.y)-Util.findAngle(r.x,r.y,i.x,i.y));o=Util.radianToDegree(o),o>180&&(o=360-o),t.push([r.getDistance(s,!0),r.getDistance(i,!0),o,r])}return t}var i=r(e),s=r(t),o=0;for(var u=0;u<i.length;u++)o<i[u][0]&&(o=i[u][0]);var a=0;for(var u=0;u<s.length;u++)a<s[u][0]&&(a=s[u][0]);var f;n==undefined?f=o/a:f=n;var l=1e-5,c=i.length;function h(e,t,n){for(var r=0;r<=c;r++){var i=!0;for(var s=0;s<=c;s++){var o=(s+r+c)%c;if(e[s%c][2]==t[o][2]){var u=e[s%c][0]/t[o][n?1:0];if(f+l>u&&f-l<u)continue;i=!1}else i=!1}if(i==1)return InteractiveGrids.MoveShapeTo(e,t,r,n),!0}}return h(i,s,false)==1?!0:h(i,s,true)==1?!0:(i=i.reverse(),h(i,s,false)==1?!0:h(i,s,true)==1?!0:!1)},InteractiveGrids.GetId=function(){return InteractiveGrids.order?InteractiveGrids.order++:(InteractiveGrids.order=1,InteractiveGrids.GetId())},InteractiveGrids.MoveShapeTo=function(e,t,n,r){if(e.length!=t.length)return;var i,s=new AnimationHelper({}),o={};console.log("reverse: "+r);for(var u=0;u<e.length;u++)o["point"+u]=e[u][3],s["point"+u]=t[(u+n+t.length-(r===!0&&t.length>3?0:0))%t.length][3];s.animate({style:o,duration:2e3,animationType:"easeInEaseOut",update:function(){i&&i.remove(),i=new Path;for(var e=0;!0;e++){if(!this["point"+e])break;i.add(this["point"+e])}i.closed=!0,i.strokeColor="#000",i.strokeWidth=2},callback:function(){Interaction.resume()}})},InteractiveGrids.prototype._drawShape=InteractiveGrids.prototype.drawShape,InteractiveGrids.prototype.drawShape=function(e,t){return t==undefined&&(t=!0),t==1&&(this._drawShape(e),this.shadowPath=this.path,this.path=null,this.shadowPath.set_style({fillColor:new RgbColor(.7,.7,.7,.3),strokeColor:new RgbColor(.3,.3,.3,.3)})),this._drawShape(e),this.path.class="draggable",this.path.set_style({fillColor:new RgbColor(Math.random()-.1,Math.random()-.1,Math.random()+.1,.8),strokeColor:new RgbColor(.4,.4,.4,1)}),this},InteractiveGrids.prototype.isPathHorizontalOverflowed=function(){var e=new Rectangle(this.position,new Size(this.size*8,this.size*8));return e.contains(new Point(this.path.bounds.x,this.position.y))?e.contains(new Point(this.path.bounds.x+this.path.bounds.width,this.position.y))?!1:!0:!0},InteractiveGrids.prototype.isPathVerticalOverflowed=function(){var e=new Rectangle(this.position,new Size(this.size*8,this.size*8));return e.contains(new Point(this.position.x,this.path.bounds.y))?e.contains(new Point(this.position.x,this.path.bounds.y+this.path.bounds.height))?!1:!0:!0},InteractiveGrids.prototype.setPathPosition=function(e){this.path.position=this.position.add(e.multiply(this.size,this.size))},InteractiveGrids.prototype.animateToNewPosition=function(e){e.delay||(e.delay=0),e.speed||(e.speed=1);var t=this.path.position,n=e.position.multiply(this.size,this.size).add(this.position);this.path.animate({style:{position:n},duration:t.getDistance(n)*10/e.speed,delay:e.delay,callback:e.callback,animationType:"easeInEaseOut"})},InteractiveGrids.prototype.appendVertexLetters=function(){},InteractiveGrids.prototype.getPathPosition=function(){return this.path.position.subtract(this.position).divide(this.size,this.size)},InteractiveGrids.prototype.createTool=function(){var e=3,t=new Tool,n=this;return t.onMouseDown=function(e){this.item=null,e.item&&e.item.class=="draggable"&&(this.item=e.item,this.firstPosition=this.item.position,this.totalDelta=new Point(0,0))},t.onMouseDrag=function(e){if(this.item){this.totalDelta=this.totalDelta.add(e.delta);var t=this.item.position;this.item.position=this.firstPosition.add(Util.round(this.totalDelta.x,n.size),Util.round(this.totalDelta.y,n.size)),n.isPathVerticalOverflowed()&&(this.item.position=new Point(this.item.position.x,t.y)),n.isPathHorizontalOverflowed()&&(this.item.position=new Point(t.x,this.item.position.y))}},t.onMouseUp=function(e){this.item=null,this.firstPosition=null,this.totalDelta=null},t.activate(),this},InteractiveGrids.CreateShape=function(e){var t=[],n=new Point(1,1),r=new Point(0,0);switch(e){case 0:t.push(new Point(1,0)),t.push(new Point(0,2)),t.push(new Point(3,2)),n=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 1:t.push(new Point(0,2)),t.push(new Point(2,2)),t.push(new Point(1,0));var i=Util.randomInteger(1,3);n=new Point(i,i),r=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5));break;case 2:t.push(new Point(0,0)),t.push(new Point(0,1)),t.push(new Point(1,1)),n=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5)),r=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5));break;case 3:t.push(new Point(1,1)),t.push(new Point(1,0)),t.push(new Point(0,1)),n=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5)),r=new Point(Util.randomInteger(1,5),Util.randomInteger(1,5));break;case 4:t.push(new Point(0,2)),t.push(new Point(2,2)),t.push(new Point(3,0)),n=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 5:t.push(new Point(2,0)),t.push(new Point(2,2)),t.push(new Point(0,2)),t.push(new Point(0,0)),n=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 6:t.push(new Point(0,0)),t.push(new Point(1,2)),t.push(new Point(3,2)),t.push(new Point(2,0)),n=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 7:t.push(new Point(1,0)),t.push(new Point(0,2)),t.push(new Point(3,2)),t.push(new Point(5,0)),n=new Point(1,Util.randomInteger(1,3)),r=new Point(Util.randomInteger(1,3),Util.randomInteger(1,3));break;case 8:t.push(new Point(0,2)),t.push(new Point(1,4)),t.push(new Point(3,4)),t.push(new Point(4,2)),t.push(new Point(2,0)),r=new Point(Util.randomInteger(1,4),Util.randomInteger(1,4));break;case 9:t.push(new Point(0,2)),t.push(new Point(1,4)),t.push(new Point(4,5)),t.push(new Point(5,2)),t.push(new Point(2,0)),r=new Point(Util.randomInteger(1,4),Util.randomInteger(1,4));break;case 10:t.push(new Point(0,2)),t.push(new Point(1,4)),t.push(new Point(3,4)),t.push(new Point(4,2)),t.push(new Point(3,0)),t.push(new Point(1,0)),r=new Point(Util.randomInteger(1,4),Util.randomInteger(1,4));break;case 11:t.push(new Point(0,2)),t.push(new Point(1,3)),t.push(new Point(3,4)),t.push(new Point(4,2)),t.push(new Point(3,0)),t.push(new Point(1,1)),r=new Point(Util.randomInteger(1,4),Util.randomInteger(1,4))}n=new Point(1,1);for(var s=0;s<t.length;s++)t[s]=t[s].multiply(n).add(r);return t};var Animation={images:[],init:function(e){Animation.grids=(new InteractiveGrids({position:new Point(305.5,10.5),size:17,style:{strokeColor:"#999"}})).drawShape([new Point(1,1),new Point(2,1),new Point(2,3),new Point(1,3),new Point(1,1),new Point(1,2),new Point(3,2),new Point(3,3),new Point(1,3)]),Animation.grids.path.set_style({fillColor:new RgbColor(.5,1,0),strokeColor:new RgbColor(0,0,0)}),AnimationManager.delay(function(){var e=new PointText(new Point(375,165));e.set_style({content:"üç birim sağa",justification:"center",fontSize:13,opacity:0}).animate({style:{opacity:1},duration:500}),Animation.grids.animateToNewPosition({position:Animation.grids.getPathPosition().add(3,0),speed:.5,delay:500,callback:function(){e.animate({style:{opacity:0},duration:500,delay:500,callback:e.remove})}})},1e3),AnimationManager.delay(function(){var e=new PointText(new Point(375,165));e.set_style({content:"dört birim aşağıya",justification:"center",fontSize:13,opacity:0}).animate({style:{opacity:1},duration:500}),Animation.grids.animateToNewPosition({position:Animation.grids.getPathPosition().add(0,4),speed:.5,delay:500,callback:function(){e.animate({style:{opacity:0},duration:500,delay:500,callback:function(){e.remove(),Main.animationFinished()}})}})},4e3)}},Interaction={getFramework:function(){return"paper"},images:[],init:function(e){Interaction.container=e,Main.setObjective("Yandaki kareli zeminde verilen şekli sürükleyerek istenen yönde öteleyiniz ve kontrol ediniz."),Interaction.paper={width:$(e).width(),height:$(e).height()},Interaction.appendButton({bottom:"0px",right:"40px"}),Interaction.appendStatus({bottom:"10px",right:"150px"}),Interaction.appendQuestion('<div id="command"></div>',{position:"absolute",right:"30px",top:"120px",width:"200px",lineHeight:"26px",fontSize:"16px",textAlign:"center",fontWeight:"bold"}),Interaction.setRandomGenerator(11),Interaction.prepareNextQuestion()},nextQuestion:function(e){Main.interactionProject.activeLayer.removeChildren(),Interaction.shape=InteractiveGrids.CreateShape(e),Interaction.grids=(new InteractiveGrids({position:new Point(100.5,23.5),size:30,style:{strokeColor:"#999"}})).drawShape(Interaction.shape).createTool(),Interaction.initialPathPosition=Interaction.grids.getPathPosition();do Interaction.generateAndShowCommand();while(function(){var e=Interaction.grids.getPathPosition().add(Interaction.command);Interaction.grids.setPathPosition(e);var t=!1;if(Interaction.grids.isPathVerticalOverflowed()||Interaction.grids.isPathHorizontalOverflowed())t=!0;return Interaction.grids.setPathPosition(Interaction.initialPathPosition),t}())},preCheck:function(){if(Interaction.initialPathPosition.equals(Interaction.grids.getPathPosition()))return Interaction.setStatus("Lütfen şekli farklı bir noktaya sürükleyiniz","alert"),!1},isAnswerCorrect:function(e){return Interaction.command.equals(Interaction.grids.getPathPosition().subtract(Interaction.initialPathPosition))},onCorrectAnswer:function(){Interaction.grids.path.set_style(interactionPathCorrectStyle)},onWrongAnswer:function(){},onFail:function(){Interaction.pause(),Interaction.grids.path.animate({style:interactionPathWrongStyle,duration:1e3,callback:function(){Interaction.grids.drawShape(Interaction.shape,!1),Interaction.grids.path.set_style({opacity:0}),Interaction.grids.path.set_style(interactionPathCorrectStyle),Interaction.grids.path.animate({style:{opacity:1},duration:500}),Interaction.grids.animateToNewPosition({position:Interaction.initialPathPosition.add(Interaction.command.multiply(1,0)),callback:function(){Interaction.grids.animateToNewPosition({position:Interaction.initialPathPosition.add(Interaction.command.multiply(1,1)),callback:Interaction.resume,speed:.8})},speed:.8,delay:1e3})}}),Interaction.setStatus("Yanlış cevap. Şekil olması gerektiği noktaya taşınacaktır.",!1)},generateAndShowCommand:function(){var e=new Point(Util.rand01()?1:-1,Util.rand01()?1:-1);e=e.multiply(Util.randomInteger(1,4),Util.randomInteger(1,4)),Interaction.setQuestionParams({id:"command",html:Interaction.commandToString(e)}),Interaction.command=e},commandToString:function(e){var t=e.x,n=e.y,r="";return t!=0&&(r+=Util.numberToString(Math.abs(t))+" birim ",r+=t>0?"sağa":"sola"),t!=0&&n!=0&&(r+=",<br/> "),n!=0&&(r+=Util.numberToString(Math.abs(n))+" birim ",r+=n>0?"aşağıya":"yukarıya"),r}};