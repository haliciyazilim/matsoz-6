var Scales2=function(e){this.animate=Item.prototype.animate,this.position=e.position,this.angle=0,this.bar=new Raster("terazi_k_02"),this.knuckle=new Raster("terazi_k_01"),this.left=new Raster("terazi_k_03"),this.right=new Raster("terazi_k_04"),this.pieces=[],this.pieces.push(this.bar),this.pieces.push(this.knuckle),this.pieces.push(this.left),this.pieces.push(this.right);for(var t=0;t<this.pieces.length;t++)this.pieces[t].position=this.position,this.pieces[t].lastTransformation=this.pieces[t].matrix;this.knucklePoint=this.position.add(0,-37),this.leftKnucklePoint=this.knucklePoint.subtract(54,0),this.rightKnucklePoint=this.knucklePoint.add(54,0),this.leftWeights=[],this.rightWeights=[],this.animationType="easeOutBounce"};Scales2.prototype.setAngle=function(e){this.angle=e;var t=new Matrix;t.rotate(this.angle,this.knucklePoint.x,this.knucklePoint.y),t.concatenate(this.bar.lastTransformation),this.bar.setMatrix(t),this.left.position=this.position.add(this.leftKnucklePoint.getRotatedPoint(e,this.knucklePoint).subtract(this.leftKnucklePoint)),this.right.position=this.position.add(this.rightKnucklePoint.getRotatedPoint(e,this.knucklePoint).subtract(this.rightKnucklePoint)),this.calculateLeftWeightPositions(),this.calculateRightWeightPositions()},Scales2.prototype.insideLeft=function(e){return e.x<this.left.position.x&&e.x>this.left.position.x-this.left.width*.5&&e.y<this.left.position.y+this.left.height*.5&&e.y>this.left.position.y},Scales2.prototype.insideRight=function(e){return e.x>this.right.position.x&&e.x<this.right.position.x+this.right.width*.5&&e.y<this.right.position.y+this.right.height*.5&&e.y>this.right.position.y},Scales2.prototype.calculateLeftWeightPositions=function(){var e=0,t=0;for(var n=0;n<this.leftWeights.length;n++)e+=this.leftWeights[n].raster.width;var r=this.left.position.add(-54,60).subtract(e/2,0);for(n=0;n<this.leftWeights.length;n++)this.leftWeights[n].raster.position=r.add(t,0).add(this.leftWeights[n].raster.width*.5,-this.leftWeights[n].raster.height*.5),t+=this.leftWeights[n].raster.width},Scales2.prototype.calculateRightWeightPositions=function(){var e=0,t=0;for(var n=0;n<this.rightWeights.length;n++)e+=this.rightWeights[n].raster.width;var r=this.right.position.add(54,60).subtract(e/2,0);for(n=0;n<this.rightWeights.length;n++)this.rightWeights[n].raster.position=r.add(t,0).add(this.rightWeights[n].raster.width*.5,-this.rightWeights[n].raster.height*.5),t+=this.rightWeights[n].raster.width},Scales2.prototype.addWeightToLeft=function(e,t){if(this.leftWeights.length>=4)return!1;e.owner=this,this.leftWeights.push(e),t==1&&this.calculateWeights(),this.calculateLeftWeightPositions()},Scales2.prototype.addWeightToRight=function(e,t){if(this.rightWeights.length>=4)return!1;e.owner=this,this.rightWeights.push(e),t==1&&this.calculateWeights(),this.calculateRightWeightPositions()},Scales2.prototype.calculateWeights=function(){var e=0,t=0;for(var n=0;n<this.leftWeights.length;n++)e+=this.leftWeights[n].value;for(var n=0;n<this.rightWeights.length;n++)t+=this.rightWeights[n].value;var r=7e3/(Math.abs(e-t)+1);e+=.3,t+=.3;var i=30;this.animationType="easeOutBounce",e<t?(r*=e/t,i*=1):e>t?(r*=t/e,i*=-1):(i=0,r=4e3,this.animationType="easeOutElastic"),this.angle!=i&&this.animateToAngle(i,r)},Scales2.prototype.animateToAngle=function(e,t){t==undefined&&(t=1e3),this._angle=this.angle,this.animate({style:{_angle:e},duration:t,delay:100,animationType:this.animationType,init:this.beforeAnimate,update:function(){this.setAngle(this._angle)},callback:function(){Interaction.resume(),this.angle==0&&this.onEqual&&this.onEqual()}})},Scales2.prototype.callOnEqual=function(e){this.onEqual=e},Scales2.prototype.callBeforeAnimate=function(e){this.beforeAnimate=e},Scales2.prototype.emptyScales=function(){$(this.leftWeights).each(function(){this.remove()}),$(this.rightWeights).each(function(){this.remove()}),this.leftWeights=[],this.rightWeights=[],this.calculateWeights()},Scales2.prototype.removeWeight=function(e,t){t==undefined&&(t=!1);var n=!1,r=this.leftWeights.indexOf(e);if(r>=0)this.leftWeights[r].remove(),this.leftWeights.splice(r,1),n=!0;else{var i=this.rightWeights.indexOf(e);i>=0&&(this.rightWeights[i].remove(),this.rightWeights.splice(i,1),n=!0)}return n&&t&&this.calculateWeights(),n};